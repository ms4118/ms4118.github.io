<!DOCTYPE html>
<html>

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <link rel="icon" href="images/fevicon.png" type="image/gif" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />

  <title>Op-Mic GOM</title>

  <link rel="stylesheet" href="pyscripts/pyscript.css" />
  <script defer src="pyscripts/pyscript.js"></script>
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="./js/intro.min.js"></script>

  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />

  <!-- font awesome style -->
  <link href="css/font-awesome.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/introjs.min.css">
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/common.css">
  <py-env>
    - numpy
    - matplotlib
  </py-env>

</head>

<body class="sub_page">
  <div class="hero_area">
    <!-- header section starts -->
    <header class="header_section long_section px-0">
      <nav class="navbar navbar-expand-lg custom_nav-container ">
        <a class="navbar-brand" href="index.html">
          <img class="logo-img" src="./images/logo1.jpg">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class=""> </span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <div class="d-flex mx-auto flex-column flex-lg-row align-items-center">
            <ul class="navbar-nav  ">
              <li class="nav-item ">
                <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="furniture.html">Forecasting Logistics</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="sustainable.html">Sustainable Logistics</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="inventory.html">Inventory Management</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="network.html">Network Optimization</a>
              </li>
              <li class="nav-item active">
                <a class="nav-link" href="01.html">Warehouse Management</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <!-- end header section -->
  </div>

    <!-- Blog section -->
<section class="blog_section layout_padding furniture_section">
    <div class="container">
      <div class="heading_container">
        <h2>
          Global Operation Management - Warehouse Management
        </h2>
      </div>
      <div class="container">
        <div class="row align-items-center">
          <!-- 左侧图片 -->
          <div class="col-md-5">
            <div class="intro-img-box">
              <img src="images/about-w-img.jpg" alt="Introduction Image" class="img-fluid">
            </div>
          </div>
          <!-- 右侧内容 -->
          <div class="col-md-7">
            <section class="slider_section long_section">
              <div id="customCarousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                  <div class="carousel-item active">
                    <div class="container p-0">
                      <div class="row">
                        <div class="col-12">
                          <div class="img-box">
                            <img src="images/warehouse/1.png" alt="" class="img-fluid">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="carousel-item">
                    <div class="container p-0">
                      <div class="row">
                        <div class="col-12">
                          <div class="img-box">
                            <img src="images/warehouse/2.png" alt="" class="img-fluid">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <ol class="carousel-indicators">
                  <li data-target="#customCarousel" data-slide-to="0" class="active"></li>
                  <li data-target="#customCarousel" data-slide-to="1"></li>              
                </ol>
              </div>
            </section>
          </div>
        </div>
    </div>

<div class="row section-container">
        <div class="detail-box">
          <h5 class="title">
            <span>Determine Number of Storage Location (m)</span>
            <span id="step2" class="course-btn" data-index="2">Watch Tutorial</span>
          </h5>
         <form id="inventoryForm"> 
          <table>
          <thead>
          <tr>
          <th>Product Name</th>
          <th>Beginning Inventory</th>
          <th>Minimum Inventory</th>
          <th>Maximum Inventory</th>
          <th>Replenishment Cycle</th>
         </tr>
         </thead>
         <tbody id="productRows">
         <tr>
          <td><input name="productName" required></td>
          <td><input type="text" name="beginInventory" required></td>
          <td><input type="text" name="minInventory" required></td>
          <td><input type="text" name="maxInventory" required></td>
          <td><input type="text" name="cycle" required></td>
          </tr>
         </tbody>
         </table>
         <button type="button" onclick="addRow()">Add Product</button>
         <button type="submit">Calculate</button>
        </form>

  <div id="results" class="output"></div>

  <script>
    function isValidNumber(value) {
  return !isNaN(value) && !isNaN(parseFloat(value)) && isFinite(value);
}
    function addRow() {
      const tbody = document.getElementById('productRows');
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input name="productName" required></td>
        <td><input type="text" name="beginInventory" required></td>
        <td><input type="text" name="minInventory" required></td>
        <td><input type="text" name="maxInventory" required></td>
        <td><input type="text" name="cycle" required></td>
      `;
      tbody.appendChild(row);
    }

    document.getElementById('inventoryForm').onsubmit = function(e) {
      e.preventDefault();
      const rows = document.querySelectorAll('#productRows tr');
      const products = [];

      rows.forEach(r => {
  const [nameEl, beginEl, minEl, maxEl, cycleEl] = r.querySelectorAll('input');
  
  // Validate numeric inputs
  if (!isValidNumber(beginEl.value) || !isValidNumber(minEl.value) || 
      !isValidNumber(maxEl.value) || !isValidNumber(cycleEl.value)) {
    alert('Please enter valid numbers for all inventory values');
    return;
  }
  
  const p = {
    name: nameEl.value,
    begin: parseFloat(beginEl.value),
    min: parseFloat(minEl.value),
    max: parseFloat(maxEl.value),
    cycle: parseFloat(cycleEl.value)
  };

        // compute shift
        p.shift = ((p.begin - p.min) / (p.max - p.min)) * p.cycle;
        products.push(p);
      });

      let output = '<h2>Calculation Steps</h2>';
      // Dedicated Storage
      const dedicated = products.reduce((sum,p)=> sum + p.max, 0);
      output += '<strong>Dedicated Storage:</strong><br>';
      products.forEach(p => {
        output += `${p.name}: ${p.max}<br>`;
      });
      output += `Total = ${dedicated}<br><br>`;

      // Random Storage
      const minCycle = Math.min(...products.map(p=>p.cycle));
      const maxTime = minCycle * products.length;
      const allCyclesSame = products.every(p => p.cycle === products[0].cycle);
      const step = allCyclesSame ? 1 : 0.5;

      let bestSum = 0, bestT = 1;

      output += '<strong>Random Storage:</strong><br>';
      for(let t=1; t<=maxTime; t+=step) {
        let sumInv = 0;
        products.forEach(p => {
          let tPrime = ((t - p.shift - 1) % p.cycle + p.cycle) % p.cycle + 1;
          let inv;
          // if tPrime ≤ 1, inventory = beginning (replenished)
          if (tPrime < 1) inv = p.begin;
          else {
            const slope = (p.max - p.min) / p.cycle;
            inv = p.max - slope * (tPrime - 1);
          }
          sumInv += inv;
          output += `${p.name} @t=${t.toFixed(1)} (t'=${tPrime.toFixed(1)}): ${inv.toFixed(1)}<br>`;
        });
        output += `Sum @t=${t.toFixed(1)} = ${sumInv.toFixed(1)}<br><br>`;
        if (sumInv > bestSum) {
          bestSum = sumInv;
          bestT = t;
        }
      }
      output += `<strong>Max Random Storage = ${bestSum.toFixed(1)} @t=${bestT.toFixed(1)}</strong>`;
      document.getElementById('results').innerHTML = output;
    };
  </script>

<!-- Inputs for Layout Parameters -->
<div style="margin-top:30px;">
  <h3>Warehouse Layout Visualizer</h3>
  <label>
    Main aisles (fixed): 
    <input type="number" id="aisleInput" value="3" min="1" readonly>
  </label>
  <label>
    nx (number of columns): 
    <input type="number" id="nxInput" min="1" value="8" onchange="drawLayout()">
  </label>
  <label>
    ny (locations per column): 
    <input type="number" id="nyInput" min="1" value="10" onchange="drawLayout()">
  </label>
  <button onclick="drawLayout()">Update Layout</button>
  <br><br>
  <canvas id="warehouseLayout" width="850" height="500" style="border:1px solid #666;"></canvas>
</div>

<script>
function drawLayout() {
  const aisles = parseInt(document.getElementById('aisleInput').value, 10);
  const nx = parseInt(document.getElementById('nxInput').value, 10);
  const ny = parseInt(document.getElementById('nyInput').value, 10);

  const canvas = document.getElementById('warehouseLayout');
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const marginLeft = 90, marginTop = 60;
  const cellWidth = Math.min(50, (canvas.width - marginLeft*2) / (nx + 2));
  const cellHeight = Math.min(40, (canvas.height - marginTop*2) / (ny + 2));
  const aisleSpacing = 40;

  // Draw Receiving Zone
  ctx.fillStyle = "#eaeaea";
  ctx.fillRect(marginLeft - 60, marginTop, 50, ny * cellHeight);
  ctx.fillStyle = "#333";
  ctx.font = "15px Arial";
  ctx.fillText("Receiving", marginLeft - 54, marginTop + (ny * cellHeight)/2);

  // Draw Shipping Zone
  ctx.fillStyle = "#eaeaea";
  ctx.fillRect(marginLeft + (nx+1) * cellWidth + aisleSpacing, marginTop, 70, ny * cellHeight);
  ctx.fillStyle = "#333";
  ctx.font = "15px Arial";
  ctx.fillText("Shipping", marginLeft + (nx+1) * cellWidth + aisleSpacing + 5, marginTop + (ny * cellHeight)/2);

  // Draw Storage Grid and numbering
  for (let col = 1; col <= nx; col++) {
    for (let row = 1; row <= ny; row++) {
      ctx.strokeRect(marginLeft + col * cellWidth, marginTop + row * cellHeight, cellWidth, cellHeight);
      ctx.font = "12px Arial";
      ctx.fillStyle = "#005edc";
      ctx.fillText(row, marginLeft + col * cellWidth + 5, marginTop + row * cellHeight + 18);
    }
    ctx.font = "16px Arial";
    ctx.fillStyle = "#c00";
    ctx.fillText(col, marginLeft + col * cellWidth + cellWidth/2 - 6, marginTop + (ny + 1) * cellHeight + 16);
  }

  // Draw aisles name underneath the grid
  for (let a = 0; a < aisles; a++) {
    const aisleY = marginTop + (ny + 1) * cellHeight + 50 + a*30;
    ctx.font = "17px Arial";
    ctx.fillStyle = "#d5531c";
    ctx.fillText(`Aisle ${a+1}`, marginLeft + cellWidth, aisleY);
  }

  // Title
  ctx.font = "23px Arial";
  ctx.fillStyle = "#e93914";
  ctx.fillText("This is a vertical layout", canvas.width/2 - 130, marginTop - 25);

  // Arrow indicators for Lx, Ly
  ctx.save();
  ctx.beginPath();
  ctx.moveTo(marginLeft, marginTop - 8);
  ctx.lineTo(marginLeft + nx * cellWidth, marginTop - 8);
  ctx.strokeStyle = "#333";
  ctx.lineWidth = 2;
  ctx.stroke();
  ctx.font = "15px Arial";
  ctx.fillStyle = "#333";
  ctx.fillText("Lx", marginLeft + nx*cellWidth/2 - 10, marginTop - 15);

  ctx.beginPath();
  ctx.moveTo(marginLeft - 8, marginTop);
  ctx.lineTo(marginLeft - 8, marginTop + ny * cellHeight);
  ctx.stroke();
  ctx.fillText("Ly", marginLeft - 35, marginTop + (ny*cellHeight)/2);
  ctx.restore();
}
window.onload = drawLayout;
</script>


  <!-- footer section -->
  <footer class="footer_section">
    <div class="container">
      <p>
        &copy; <span id="displayYear"></span> Op-Mic GOM 2025
      </p>
    </div>
  </footer>
  <!-- footer section -->

  <!-- bootstrap js -->
  <script src="js/bootstrap.js"></script>

</body>

<script>
  $(document).ready(function () {
    var steps = [
      {
        element: '#step1',
        intro: '<div class="tip-box"><img src="./images/intro/step31.jpg" style="width:100%;height:auto;"></div>',
        tooltipClass: 'step-tooltip',
        // position: 'bottom-right-aligned'
      },
    ]

    $(".course-btn").click(function () {
      var offset = $(this).offset();
      console.log("offset:", offset, $(this).index)

      var index = Number($(this).data("index"))

      $('body').find('.step-helperLayer').remove();

      // decoration
      var sw = $(window).width();
      var w = $(this).width();
      var h = $(this).height();
      $('body').append(`<div class="step-helperLayer" style="width:${w}px;height:${h}px;top:${offset.top}px;left:${offset.left}px;box-shadow:rgba(33, 33, 33, 0.8) 0px 0px 1px 2px, rgba(33, 33, 33, 0.5) 0px 0px 0px 5000px"></div>`);
      var stepfixedDom = $(`<div class='step-fixed-container' style="top:${offset.top + h}px;right:${sw - offset.left - w / 2}px"></div>`)

      var stepImg = $(`${steps[index - 1].intro}`);
      var sanjiaox = $(`<div class="triangle-up"></div>`)
      var closeDom = $(`<div class="close-btn"><img src="./images/close.png" /></div>`)

      // stepfixedDom
      stepfixedDom.append(stepImg);
      stepfixedDom.append(sanjiaox);
      stepfixedDom.append(closeDom);
      $('body').append(stepfixedDom)
    })

    $('body').on('click', '.step-fixed-container .close-btn', function () {
      $('body').find('.step-helperLayer').remove();
      $('body').find('.step-fixed-container').remove();
    });
    
  });
  
  
</script>

</html>