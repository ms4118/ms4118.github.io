<!DOCTYPE html>
<html>

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <link rel="icon" href="images/fevicon.png" type="image/gif" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />

  <title>Op-Mic GOM</title>

  <link rel="stylesheet" href="pyscripts/pyscript.css" />
  <script defer src="pyscripts/pyscript.js"></script>
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="./js/intro.min.js"></script>

  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />

  <!-- font awesome style -->
  <link href="css/font-awesome.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/introjs.min.css">
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/common.css">
  <py-env>
    - numpy
    - matplotlib
  </py-env>

</head>

<body class="sub_page">
  <div class="hero_area">
    <!-- header section starts -->
    <header class="header_section long_section px-0">
      <nav class="navbar navbar-expand-lg custom_nav-container ">
        <a class="navbar-brand" href="index.html">
          <img class="logo-img" src="./images/logo1.jpg">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class=""> </span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <div class="d-flex mx-auto flex-column flex-lg-row align-items-center">
            <ul class="navbar-nav  ">
              <li class="nav-item ">
                <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="furniture.html">Forecasting Logistics</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="sustainable.html">Sustainable Logistics</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="inventory.html">Inventory Management</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="network.html">Network Optimization</a>
              </li>
              <li class="nav-item active">
                <a class="nav-link" href="01.html">Warehouse Management</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <!-- end header section -->
  </div>

    <!-- Blog section -->
<section class="blog_section layout_padding furniture_section">
    <div class="container">
      <div class="heading_container">
        <h2>
          Global Operation Management - Warehouse Management
        </h2>
      </div>
      <div class="container">
        <div class="row align-items-center">
          <!-- 左侧图片 -->
          <div class="col-md-5">
            <div class="intro-img-box">
              <img src="images/about-w-img.jpg" alt="Introduction Image" class="img-fluid">
            </div>
          </div>
          <!-- 右侧内容 -->
          <div class="col-md-7">
            <section class="slider_section long_section">
              <div id="customCarousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                  <div class="carousel-item active">
                    <div class="container p-0">
                      <div class="row">
                        <div class="col-12">
                          <div class="img-box">
                            <img src="images/warehouse/1.png" alt="" class="img-fluid">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="carousel-item">
                    <div class="container p-0">
                      <div class="row">
                        <div class="col-12">
                          <div class="img-box">
                            <img src="images/warehouse/2.png" alt="" class="img-fluid">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <ol class="carousel-indicators">
                  <li data-target="#customCarousel" data-slide-to="0" class="active"></li>
                  <li data-target="#customCarousel" data-slide-to="1"></li>              
                </ol>
              </div>
            </section>
          </div>
        </div>
    </div>

<div class="row section-container">
        <div class="detail-box">
          <h5 class="title">
            <span>Determine Number of Storage Location (m)</span>
            <span id="step2" class="course-btn" data-index="2">Watch Tutorial</span>
          </h5>
         <form id="inventoryForm"> 
          <table>
          <thead>
          <tr>
          <th>Product Name</th>
          <th>Beginning Inventory</th>
          <th>Minimum Inventory</th>
          <th>Maximum Inventory</th>
          <th>Replenishment Cycle</th>
         </tr>
         </thead>
         <tbody id="productRows">
         <tr>
          <td><input name="productName" required></td>
          <td><input type="text" name="beginInventory" required></td>
          <td><input type="text" name="minInventory" required></td>
          <td><input type="text" name="maxInventory" required></td>
          <td><input type="text" name="cycle" required></td>
          </tr>
         </tbody>
         </table>
         <button type="button" onclick="addRow()">Add Product</button>
         <button type="submit">Calculate</button>
        </form>

  <div id="results" class="output"></div>

  <script>
    function isValidNumber(value) {
  return !isNaN(value) && !isNaN(parseFloat(value)) && isFinite(value);
}
    function addRow() {
      const tbody = document.getElementById('productRows');
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input name="productName" required></td>
        <td><input type="text" name="beginInventory" required></td>
        <td><input type="text" name="minInventory" required></td>
        <td><input type="text" name="maxInventory" required></td>
        <td><input type="text" name="cycle" required></td>
      `;
      tbody.appendChild(row);
    }

    document.getElementById('inventoryForm').onsubmit = function(e) {
      e.preventDefault();
      const rows = document.querySelectorAll('#productRows tr');
      const products = [];

      rows.forEach(r => {
  const [nameEl, beginEl, minEl, maxEl, cycleEl] = r.querySelectorAll('input');
  
  // Validate numeric inputs
  if (!isValidNumber(beginEl.value) || !isValidNumber(minEl.value) || 
      !isValidNumber(maxEl.value) || !isValidNumber(cycleEl.value)) {
    alert('Please enter valid numbers for all inventory values');
    return;
  }
  
  const p = {
    name: nameEl.value,
    begin: parseFloat(beginEl.value),
    min: parseFloat(minEl.value),
    max: parseFloat(maxEl.value),
    cycle: parseFloat(cycleEl.value)
  };

        // compute shift
        p.shift = ((p.begin - p.min) / (p.max - p.min)) * p.cycle;
        products.push(p);
      });

      let output = '<h2>Calculation Steps</h2>';
      // Dedicated Storage
      const dedicated = products.reduce((sum,p)=> sum + p.max, 0);
      output += '<strong>Dedicated Storage:</strong><br>';
      products.forEach(p => {
        output += `${p.name}: ${p.max}<br>`;
      });
      output += `Total = ${dedicated}<br><br>`;

      // Random Storage
      const minCycle = Math.min(...products.map(p=>p.cycle));
      const maxTime = minCycle * products.length;
      const allCyclesSame = products.every(p => p.cycle === products[0].cycle);
      const step = allCyclesSame ? 1 : 0.5;

      let bestSum = 0, bestT = 1;

      output += '<strong>Random Storage:</strong><br>';
      for(let t=1; t<=maxTime; t+=step) {
        let sumInv = 0;
        products.forEach(p => {
          let tPrime = ((t - p.shift - 1) % p.cycle + p.cycle) % p.cycle + 1;
          let inv;
          // if tPrime ≤ 1, inventory = beginning (replenished)
          if (tPrime < 1) inv = p.begin;
          else {
            const slope = (p.max - p.min) / p.cycle;
            inv = p.max - slope * (tPrime - 1);
          }
          sumInv += inv;
          output += `${p.name} @t=${t.toFixed(1)} (t'=${tPrime.toFixed(1)}): ${inv.toFixed(1)}<br>`;
        });
        output += `Sum @t=${t.toFixed(1)} = ${sumInv.toFixed(1)}<br><br>`;
        if (sumInv > bestSum) {
          bestSum = sumInv;
          bestT = t;
        }
      }
      output += `<strong>Max Random Storage = ${bestSum.toFixed(1)} @t=${bestT.toFixed(1)}</strong>`;
      document.getElementById('results').innerHTML = output;
    };
  </script>

<!-- Inputs for Layout Parameters -->
<div style="margin-top:30px;">
  <h3>Warehouse Storage Zone Visualizer</h3>
  <label>
    Orientation: 
    <select id="orientationInput" onchange="drawStorageZone()">
      <option value="Vertical">Vertical</option>
      <option value="Horizontal">Horizontal</option>
    </select>
  </label>
  <label>
    Main aisles: 
    <select id="mainAislesInput" onchange="drawStorageZone()">
      <option value="1">1</option>
      <option value="3" selected>3</option>
    </select>
  </label>
  <label>
    Aisles: 
    <input type="number" id="aislesInput" min="1" value="4" onchange="drawStorageZone()">
  </label>
  <label>
    Columns (nx): 
    <input type="number" id="nxInput" min="1" value="6" onchange="drawStorageZone()">
  </label>
  <label>
    Locations per column (ny): 
    <input type="number" id="nyInput" min="1" value="4" onchange="drawStorageZone()">
  </label>
  <button onclick="drawStorageZone()">Update Layout</button>
  <br><br>
  <canvas id="zoneCanvas" width="950" height="570" style="border:1px solid #444;background:#ffffff;"></canvas>
</div>
<script>
function drawStorageZone() {
  const orientation = document.getElementById('orientationInput').value;
  const mainAisles = parseInt(document.getElementById('mainAislesInput').value, 10);
  const numAisles = parseInt(document.getElementById('aislesInput').value, 10);
  const nx = parseInt(document.getElementById('nxInput').value, 10);
  const ny = parseInt(document.getElementById('nyInput').value, 10);

  const canvas = document.getElementById('zoneCanvas');
  const ctx = canvas.getContext('2d');
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Fill canvas with white background
  ctx.fillStyle = '#ffffff';
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  const marginX = 80, marginY = 50;
  const warehouseWidth = canvas.width - 2 * marginX;
  const warehouseHeight = canvas.height - 2 * marginY;

  // Draw warehouse perimeter (black border)
  ctx.strokeStyle = '#000';
  ctx.lineWidth = 3;
  ctx.strokeRect(marginX, marginY, warehouseWidth, warehouseHeight);

  // Calculate storage area dimensions
  const storageMargin = 40;
  const storageX = marginX + storageMargin;
  const storageY = marginY + storageMargin;
  const storageWidth = warehouseWidth - 2 * storageMargin;
  const storageHeight = warehouseHeight - 2 * storageMargin;

  // Space for main aisles and aisles
  const mainAisleSize = 36, aisleSize = 28;
  let blockCols, blockRows;
  let colPerAisle, rowPerMainAisle;

  if (orientation === "Vertical") {
    blockCols = numAisles;
    blockRows = mainAisles;
    colPerAisle = Math.floor(nx / blockCols);

    // Handle different main aisle counts
    if (mainAisles === 1) {
      // Single main aisle in the middle
      rowPerMainAisle = ny; // All rows in one block
    } else {
      // 3 main aisles: top, middle, bottom
      rowPerMainAisle = Math.floor(ny / blockRows);
    }

    // Calculate cell sizes
    const totalAisleSpace = (blockCols - 1) * aisleSize;
    const totalMainAisleSpace = (blockRows - 1) * mainAisleSize;
    const cellW = (storageWidth - totalAisleSpace) / nx;
    const cellH = (storageHeight - totalMainAisleSpace) / ny;

    // Draw storage locations (grid cells)
    ctx.strokeStyle = '#000';
    ctx.lineWidth = 1;
    for (let col = 0; col < nx; col++) {
      for (let row = 0; row < ny; row++) {
        let aisleOffset = Math.floor(col / colPerAisle) * aisleSize;
        let mainAisleOffset;

        if (mainAisles === 1) {
          // No main aisle offset for storage locations
          mainAisleOffset = 0;
        } else {
          // Calculate offset for 3 main aisles
          mainAisleOffset = Math.floor(row / rowPerMainAisle) * mainAisleSize;
        }

        const x = storageX + col * cellW + aisleOffset;
        const y = storageY + row * cellH + mainAisleOffset;

        ctx.strokeRect(x, y, cellW, cellH);
      }
    }

    // Draw main aisles (horizontal)
    ctx.fillStyle = '#f0f0f0';

    if (mainAisles === 1) {
      // Single main aisle connecting entry to exit (horizontal center)
      const centerY = marginY + warehouseHeight / 2 - mainAisleSize / 2;
      ctx.fillRect(marginX, centerY, warehouseWidth, mainAisleSize);
    } else {
      // 3 main aisles: one connects entry-exit, others at top and bottom
      for (let m = 1; m < blockRows; m++) {
        let y = storageY + m * rowPerMainAisle * cellH + (m-1)*mainAisleSize;
        if (m === 1) {
          // Middle main aisle extends to warehouse walls (connects entry-exit)
          ctx.fillRect(marginX, y, warehouseWidth, mainAisleSize);
        } else {
          // Other main aisles only within storage area
          ctx.fillRect(storageX, y, storageWidth, mainAisleSize);
        }
      }
    }

    // Draw aisles (vertical)
    ctx.fillStyle = '#f8f8f8';
    for (let a = 1; a < blockCols; a++) {
      let x = storageX + a * colPerAisle * cellW + (a-1)*aisleSize;
      ctx.fillRect(x, storageY, aisleSize, storageHeight);
    }

  } else {
    // Horizontal orientation
    blockRows = numAisles;
    blockCols = mainAisles;
    rowPerAisle = Math.floor(ny / blockRows);

    // Handle different main aisle counts
    if (mainAisles === 1) {
      // Single main aisle in the middle
      colPerMainAisle = nx; // All columns in one block
    } else {
      // 3 main aisles: left, center, right
      colPerMainAisle = Math.floor(nx / blockCols);
    }

    const totalAisleSpace = (blockRows - 1) * aisleSize;
    const totalMainAisleSpace = (blockCols - 1) * mainAisleSize;
    const cellH = (storageHeight - totalAisleSpace) / ny;
    const cellW = (storageWidth - totalMainAisleSpace) / nx;

    // Draw storage locations
    ctx.strokeStyle = '#000';
    ctx.lineWidth = 1;
    for (let row = 0; row < ny; row++) {
      for (let col = 0; col < nx; col++) {
        let aisleOffset = Math.floor(row / rowPerAisle) * aisleSize;
        let mainAisleOffset;

        if (mainAisles === 1) {
          mainAisleOffset = 0;
        } else {
          mainAisleOffset = Math.floor(col / colPerMainAisle) * mainAisleSize;
        }

        const x = storageX + col * cellW + mainAisleOffset;
        const y = storageY + row * cellH + aisleOffset;

        ctx.strokeRect(x, y, cellW, cellH);
      }
    }

    // Draw main aisles (vertical)
    ctx.fillStyle = '#f0f0f0';

    if (mainAisles === 1) {
      // Single main aisle connecting entry to exit (vertical center)
      const centerX = marginX + warehouseWidth / 2 - mainAisleSize / 2;
      ctx.fillRect(centerX, marginY, mainAisleSize, warehouseHeight);
    } else {
      // 3 main aisles
      for (let m = 1; m < blockCols; m++) {
        let x = storageX + m * colPerMainAisle * cellW + (m-1)*mainAisleSize;
        if (m === 1) {
          // Middle main aisle extends to warehouse walls (connects entry-exit)
          ctx.fillRect(x, marginY, mainAisleSize, warehouseHeight);
        } else {
          // Other main aisles only within storage area
          ctx.fillRect(x, storageY, mainAisleSize, storageHeight);
        }
      }
    }

    // Draw aisles (horizontal)
    ctx.fillStyle = '#f8f8f8';
    for (let a = 1; a < blockRows; a++) {
      let y = storageY + a * rowPerAisle * cellH + (a-1)*aisleSize;
      ctx.fillRect(storageX, y, storageWidth, aisleSize);
    }
  }

  // Draw entry/exit arrows (green)
  ctx.fillStyle = '#22c55e';
  ctx.strokeStyle = '#22c55e';
  const arrowSize = 25;

  // Left entry arrow
  const leftArrowX = marginX - arrowSize - 10;
  const leftArrowY = marginY + warehouseHeight/2;
  drawArrow(ctx, leftArrowX, leftArrowY, leftArrowX + arrowSize, leftArrowY, arrowSize/3);

  // Right exit arrow  
  const rightArrowX = marginX + warehouseWidth + 10;
  const rightArrowY = marginY + warehouseHeight/2;
  drawArrow(ctx, rightArrowX, rightArrowY, rightArrowX + arrowSize, rightArrowY, arrowSize/3);

  // Title
  ctx.font = "18px Arial";
  ctx.fillStyle = "#e93914";
  ctx.textAlign = "center";
  ctx.fillText("Storage Zone Layout: " + orientation, canvas.width/2, marginY - 15);
  ctx.textAlign = "left";
}

function drawArrow(ctx, fromX, fromY, toX, toY, headSize) {
  const angle = Math.atan2(toY - fromY, toX - fromX);

  // Draw arrow line
  ctx.beginPath();
  ctx.moveTo(fromX, fromY);
  ctx.lineTo(toX, toY);
  ctx.lineWidth = 3;
  ctx.stroke();

  // Draw arrow head
  ctx.beginPath();
  ctx.moveTo(toX, toY);
  ctx.lineTo(toX - headSize * Math.cos(angle - Math.PI/6), toY - headSize * Math.sin(angle - Math.PI/6));
  ctx.moveTo(toX, toY);
  ctx.lineTo(toX - headSize * Math.cos(angle + Math.PI/6), toY - headSize * Math.sin(angle + Math.PI/6));
  ctx.stroke();
}

window.onload = drawStorageZone;
</script>


  <!-- footer section -->
  <footer class="footer_section">
    <div class="container">
      <p>
        &copy; <span id="displayYear"></span> Op-Mic GOM 2025
      </p>
    </div>
  </footer>
  <!-- footer section -->

  <!-- bootstrap js -->
  <script src="js/bootstrap.js"></script>

</body>

<script>
  $(document).ready(function () {
    var steps = [
      {
        element: '#step1',
        intro: '<div class="tip-box"><img src="./images/intro/step31.jpg" style="width:100%;height:auto;"></div>',
        tooltipClass: 'step-tooltip',
        // position: 'bottom-right-aligned'
      },
    ]

    $(".course-btn").click(function () {
      var offset = $(this).offset();
      console.log("offset:", offset, $(this).index)

      var index = Number($(this).data("index"))

      $('body').find('.step-helperLayer').remove();

      // decoration
      var sw = $(window).width();
      var w = $(this).width();
      var h = $(this).height();
      $('body').append(`<div class="step-helperLayer" style="width:${w}px;height:${h}px;top:${offset.top}px;left:${offset.left}px;box-shadow:rgba(33, 33, 33, 0.8) 0px 0px 1px 2px, rgba(33, 33, 33, 0.5) 0px 0px 0px 5000px"></div>`);
      var stepfixedDom = $(`<div class='step-fixed-container' style="top:${offset.top + h}px;right:${sw - offset.left - w / 2}px"></div>`)

      var stepImg = $(`${steps[index - 1].intro}`);
      var sanjiaox = $(`<div class="triangle-up"></div>`)
      var closeDom = $(`<div class="close-btn"><img src="./images/close.png" /></div>`)

      // stepfixedDom
      stepfixedDom.append(stepImg);
      stepfixedDom.append(sanjiaox);
      stepfixedDom.append(closeDom);
      $('body').append(stepfixedDom)
    })

    $('body').on('click', '.step-fixed-container .close-btn', function () {
      $('body').find('.step-helperLayer').remove();
      $('body').find('.step-fixed-container').remove();
    });
    
  });
  
  
</script>

</html>