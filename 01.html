<!DOCTYPE html>
<html>

<head>
  <!-- Basic -->
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <!-- Mobile Metas -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <!-- Site Metas -->
  <link rel="icon" href="images/fevicon.png" type="image/gif" />
  <meta name="keywords" content="" />
  <meta name="description" content="" />
  <meta name="author" content="" />

  <title>Op-Mic GOM</title>

  <link rel="stylesheet" href="pyscripts/pyscript.css" />
  <script defer src="pyscripts/pyscript.js"></script>
  <script src="js/jquery-3.4.1.min.js"></script>
  <script src="./js/intro.min.js"></script>

  <!-- bootstrap core css -->
  <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />

  <!-- font awesome style -->
  <link href="css/font-awesome.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/introjs.min.css">
  <!-- Custom styles for this template -->
  <link href="css/style.css" rel="stylesheet" />
  <!-- responsive style -->
  <link href="css/responsive.css" rel="stylesheet" />
  <link rel="stylesheet" href="css/common.css">
  <py-env>
    - numpy
    - matplotlib
  </py-env>

</head>

<body class="sub_page">
  <div class="hero_area">
    <!-- header section starts -->
    <header class="header_section long_section px-0">
      <nav class="navbar navbar-expand-lg custom_nav-container ">
        <a class="navbar-brand" href="index.html">
          <img class="logo-img" src="./images/logo1.jpg">
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class=""> </span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <div class="d-flex mx-auto flex-column flex-lg-row align-items-center">
            <ul class="navbar-nav  ">
              <li class="nav-item ">
                <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="furniture.html">Forecasting Logistics</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="sustainable.html">Sustainable Logistics</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="inventory.html">Inventory Management</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="network.html">Network Optimization</a>
              </li>
              <li class="nav-item active">
                <a class="nav-link" href="01.html">Warehouse Management</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <!-- end header section -->
  </div>

    <!-- Blog section -->
<section class="blog_section layout_padding furniture_section">
    <div class="container">
      <div class="heading_container">
        <h2>
          Global Operation Management - Warehouse Management
        </h2>
      </div>
      <div class="container">
        <div class="row align-items-center">
          <!-- 左侧图片 -->
          <div class="col-md-5">
            <div class="intro-img-box">
              <img src="images/about-w-img.jpg" alt="Introduction Image" class="img-fluid">
            </div>
          </div>
          <!-- 右侧内容 -->
          <div class="col-md-7">
            <section class="slider_section long_section">
              <div id="customCarousel" class="carousel slide" data-ride="carousel">
                <div class="carousel-inner">
                  <div class="carousel-item active">
                    <div class="container p-0">
                      <div class="row">
                        <div class="col-12">
                          <div class="img-box">
                            <img src="images/warehouse/1.png" alt="" class="img-fluid">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="carousel-item">
                    <div class="container p-0">
                      <div class="row">
                        <div class="col-12">
                          <div class="img-box">
                            <img src="images/warehouse/2.png" alt="" class="img-fluid">
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <ol class="carousel-indicators">
                  <li data-target="#customCarousel" data-slide-to="0" class="active"></li>
                  <li data-target="#customCarousel" data-slide-to="1"></li>              
                </ol>
              </div>
            </section>
          </div>
        </div>
    </div>

<div class="row section-container">
        <div class="detail-box">
          <h5 class="title">
            <span>Determine Number of Storage Location (m)</span>
            <span id="step2" class="course-btn" data-index="2">Watch Tutorial</span>
          </h5>
         <form id="inventoryForm"> 
          <table>
          <thead>
          <tr>
          <th>Product Name</th>
          <th>Beginning Inventory</th>
          <th>Minimum Inventory</th>
          <th>Maximum Inventory</th>
          <th>Replenishment Cycle</th>
         </tr>
         </thead>
         <tbody id="productRows">
         <tr>
          <td><input name="productName" required></td>
          <td><input type="text" name="beginInventory" required></td>
          <td><input type="text" name="minInventory" required></td>
          <td><input type="text" name="maxInventory" required></td>
          <td><input type="text" name="cycle" required></td>
          </tr>
         </tbody>
         </table>
         <button type="button" onclick="addRow()">Add Product</button>
         <button type="submit">Calculate</button>
        </form>

  <div id="results" class="output"></div>

  <script>
    function isValidNumber(value) {
  return !isNaN(value) && !isNaN(parseFloat(value)) && isFinite(value);
}
    function addRow() {
      const tbody = document.getElementById('productRows');
      const row = document.createElement('tr');
      row.innerHTML = `
        <td><input name="productName" required></td>
        <td><input type="text" name="beginInventory" required></td>
        <td><input type="text" name="minInventory" required></td>
        <td><input type="text" name="maxInventory" required></td>
        <td><input type="text" name="cycle" required></td>
      `;
      tbody.appendChild(row);
    }

    document.getElementById('inventoryForm').onsubmit = function(e) {
      e.preventDefault();
      const rows = document.querySelectorAll('#productRows tr');
      const products = [];

      rows.forEach(r => {
  const [nameEl, beginEl, minEl, maxEl, cycleEl] = r.querySelectorAll('input');
  
  // Validate numeric inputs
  if (!isValidNumber(beginEl.value) || !isValidNumber(minEl.value) || 
      !isValidNumber(maxEl.value) || !isValidNumber(cycleEl.value)) {
    alert('Please enter valid numbers for all inventory values');
    return;
  }
  
  const p = {
    name: nameEl.value,
    begin: parseFloat(beginEl.value),
    min: parseFloat(minEl.value),
    max: parseFloat(maxEl.value),
    cycle: parseFloat(cycleEl.value)
  };

        // compute shift
        p.shift = ((p.begin - p.min) / (p.max - p.min)) * p.cycle;
        products.push(p);
      });

      let output = '<h2>Calculation Steps</h2>';
      // Dedicated Storage
      const dedicated = products.reduce((sum,p)=> sum + p.max, 0);
      output += '<strong>Dedicated Storage:</strong><br>';
      products.forEach(p => {
        output += `${p.name}: ${p.max}<br>`;
      });
      output += `Total = ${dedicated}<br><br>`;

      // Random Storage
      const minCycle = Math.min(...products.map(p=>p.cycle));
      const maxTime = minCycle * products.length;
      const allCyclesSame = products.every(p => p.cycle === products[0].cycle);
      const step = allCyclesSame ? 1 : 0.5;

      let bestSum = 0, bestT = 1;

      output += '<strong>Random Storage:</strong><br>';
      for(let t=1; t<=maxTime; t+=step) {
        let sumInv = 0;
        products.forEach(p => {
          let tPrime = ((t - p.shift - 1) % p.cycle + p.cycle) % p.cycle + 1;
          let inv;
          // if tPrime ≤ 1, inventory = beginning (replenished)
          if (tPrime < 1) inv = p.begin;
          else {
            const slope = (p.max - p.min) / p.cycle;
            inv = p.max - slope * (tPrime - 1);
          }
          sumInv += inv;
          output += `${p.name} @t=${t.toFixed(1)} (t'=${tPrime.toFixed(1)}): ${inv.toFixed(1)}<br>`;
        });
        output += `Sum @t=${t.toFixed(1)} = ${sumInv.toFixed(1)}<br><br>`;
        if (sumInv > bestSum) {
          bestSum = sumInv;
          bestT = t;
        }
      }
      output += `<strong>Max Random Storage = ${bestSum.toFixed(1)} @t=${bestT.toFixed(1)}</strong>`;
      document.getElementById('results').innerHTML = output;
    };
  </script>

<!-- Inputs for Layout Parameters -->
<head>
    <meta charset="UTF-8">
    <title>Warehouse Storage Zone Visualizer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .input-group {
            margin: 10px 0;
        }
        label {
            display: inline-block;
            width: 180px;
        }
        canvas {
            border: 1px solid #555;
            margin-top: 20px;
            background: #fff;
        }
    </style>
</head>
<body>
    <h2>Warehouse Storage Zone Visualizer</h2>
    <form id="warehouseForm">
        <div class="input-group">
            <label for="alpha">Box size (α):</label>
            <input type="number" id="alpha" value="40" min="1" step="1" required>
        </div>
        <div class="input-group">
            <label for="wx">Sub aisle width (wx):</label>
            <input type="number" id="wx" value="20" min="1" step="1" required>
        </div>
        <div class="input-group">
            <label for="wy">Main aisle width (wy):</label>
            <input type="number" id="wy" value="40" min="1" step="1" required>
        </div>
        <div class="input-group">
            <label for="nx">Boxes horizontally (nx, even):</label>
            <input type="number" id="nx" value="8" min="2" step="2" required>
        </div>
        <div class="input-group">
            <label for="ny">Boxes vertically (ny):</label>
            <input type="number" id="ny" value="10" min="1" step="1" required>
        </div>
        <div class="input-group">
            <label for="aisleCount">No. of main aisles:</label>
            <select id="aisleCount">
                <option value="1">1</option>
                <option value="3">3</option>
            </select>
        </div>
        <button type="submit">Visualize</button>
    </form>
    <canvas id="warehouseCanvas" width="900" height="600"></canvas>

    <script>
        document.getElementById('warehouseForm').addEventListener('submit', function (e) {
            e.preventDefault();
            drawWarehouse();
        });

        function drawWarehouse() {
            // Get inputs
            let alpha = parseInt(document.getElementById('alpha').value, 10);
            let wx = parseInt(document.getElementById('wx').value, 10);
            let wy = parseInt(document.getElementById('wy').value, 10);
            let nx = parseInt(document.getElementById('nx').value, 10);
            let ny = parseInt(document.getElementById('ny').value, 10);
            let aisleCount = parseInt(document.getElementById('aisleCount').value, 10);

            if (nx % 2 !== 0) {
                alert("nx must be even.");
                return;
            }

            // Prepare canvas
            const canvas = document.getElementById('warehouseCanvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Compute number of sub-aisles
            const subAisleCount = nx / 2;

            // Compute number of columns (nx) and rows (ny)
            // Layout: [wall][box][box][sub aisle][box][box][sub aisle]...[box][box][wall]
            // The width: nx * alpha + (subAisleCount) * wx

            // Main aisle(s) logic
            let mainAislePositions = [];
            if (aisleCount === 1) {
                mainAislePositions.push(0.5); // middle (normalized)
            } else {
                mainAislePositions.push(0.0);  // top
                mainAislePositions.push(0.5);  // middle
                mainAislePositions.push(1.0);  // bottom
            }

            // For vertical lines, we split ny into two blocks separated by the middle main aisle
            // If ny is even, split equally; if odd, the lower half gets the extra box
            let nyUpper = Math.floor(ny / 2);
            let nyLower = ny - nyUpper;

            // Draw size calculation
            const totalWarehouseWidth =
                nx * alpha +
                (subAisleCount) * wx; // Storage width

            const totalMainAisleHeight = mainAislePositions.length * wy;
            const totalStorageHeight = ny * alpha;

            const totalWarehouseHeight = totalStorageHeight + totalMainAisleHeight;

            // Center warehouse on canvas
            const canvasMargin = 60;
            const offsetX = (canvas.width - totalWarehouseWidth) / 2;
            const offsetY = (canvas.height - totalWarehouseHeight) / 2;

            // Draw boundary
            ctx.save();
            ctx.strokeStyle = "#444";
            ctx.lineWidth = 2;
            ctx.strokeRect(offsetX, offsetY, totalWarehouseWidth, totalWarehouseHeight);
            ctx.restore();

            // Draw main aisle(s)
            let aisleYs = [];
            let startY = offsetY;
            for (let i = 0; i < mainAislePositions.length; i++) {
                let pos = mainAislePositions[i];
                let y = offsetY + pos * (totalStorageHeight + ((mainAislePositions.length - 1) * wy));
                aisleYs.push(y);
                ctx.fillStyle = "#e0e0e0";
                ctx.fillRect(offsetX, y, totalWarehouseWidth, wy);
            }

            // Draw sub-aisles (vertical), also mark in red
            let col = 0;
            for (let s = 0; s < subAisleCount; s++) {
                let xSub = offsetX + ((col + 2) * alpha) + (s * wx) + (s * 2 * alpha);
                ctx.save();
                ctx.fillStyle = "rgba(255,0,0,0.2)";
                ctx.fillRect(xSub, offsetY, wx, totalWarehouseHeight);
                ctx.restore();
                col += 2;
            }

            // Draw boxes
            col = 0;
            for (let bx = 0; bx < nx; bx++) {
                // Compute x position of this box column
                let aisleBefore = Math.floor(bx / 2);
                let boxX = offsetX + bx * alpha + aisleBefore * wx;

                // Draw upper part (from wall to main aisle above/below)
                let yUpper = offsetY;
                let boxesUpper = 0;
                let mainAisleFound = false;

                // Determine how many boxes before main aisle, and after
                // The general plan: for each main aisle, compute where it is and how many boxes are above/below for each section
                if (aisleCount === 1) {
                    // Only one main aisle in the center
                    boxesUpper = nyUpper;
                } else {
                    // Three main aisles: top, middle, bottom
                    // Top aisle (no boxes), then upper boxes, middle aisle, lower boxes, bottom aisle (no boxes)
                    boxesUpper = Math.floor(ny / 2);
                }

                // Draw upper boxes
                for (let by = 0; by < boxesUpper; by++) {
                    let boxY = offsetY + by * alpha;
                    ctx.save();
                    ctx.fillStyle = "#b3e5fc";
                    ctx.strokeStyle = "#0288d1";
                    ctx.lineWidth = 2;
                    ctx.fillRect(boxX, boxY, alpha, alpha);
                    ctx.strokeRect(boxX, boxY, alpha, alpha);
                    ctx.restore();
                }

                // Draw lower boxes
                // Lower boxes start after main aisle of width `wy`
                let offset_m = nyUpper * alpha + wy;
                let lowerBoxes = ny - boxesUpper;
                if (aisleCount === 3) {
                    // If three main aisles, distribute differently:
                    // top aisle, upper boxes, middle aisle, lower boxes, bottom aisle
                    // Account for space and only draw between aisles
                    // top aisle: wy at offsetY (skip drawing)
                    // upper part: upperRows, starts at offsetY+wy
                    // middle aisle: wy
                    // lower part: lowerRows, starts after main+middle aisle(s)
                    // bottom aisle: wy at end (skip drawing)
                    let upperRows = Math.floor(ny/2);
                    let lowerRows = ny - upperRows;
                    // Upper part:
                    for (let by = 0; by < upperRows; by++) {
                        let boxY = offsetY + wy + by * alpha;
                        ctx.save();
                        ctx.fillStyle = "#b3e5fc";
                        ctx.strokeStyle = "#0288d1";
                        ctx.lineWidth = 2;
                        ctx.fillRect(boxX, boxY, alpha, alpha);
                        ctx.strokeRect(boxX, boxY, alpha, alpha);
                        ctx.restore();
                    }
                    // Lower part:
                    for (let by = 0; by < lowerRows; by++) {
                        let boxY = offsetY + wy + upperRows * alpha + wy + by * alpha;
                        ctx.save();
                        ctx.fillStyle = "#b3e5fc";
                        ctx.strokeStyle = "#0288d1";
                        ctx.lineWidth = 2;
                        ctx.fillRect(boxX, boxY, alpha, alpha);
                        ctx.strokeRect(boxX, boxY, alpha, alpha);
                        ctx.restore();
                    }
                } else {
                    // Standard two region (upper & lower) split by middle aisle
                    for (let by = 0; by < lowerBoxes; by++) {
                        let boxY = offsetY + boxesUpper * alpha + wy + by * alpha;
                        ctx.save();
                        ctx.fillStyle = "#b3e5fc";
                        ctx.strokeStyle = "#0288d1";
                        ctx.lineWidth = 2;
                        ctx.fillRect(boxX, boxY, alpha, alpha);
                        ctx.strokeRect(boxX, boxY, alpha, alpha);
                        ctx.restore();
                    }
                }
            }

            // Draw Entry (left side)
            ctx.save();
            ctx.fillStyle = "green";
            ctx.beginPath();
            ctx.moveTo(offsetX-40, offsetY + totalWarehouseHeight/2 - 15);
            ctx.lineTo(offsetX-10, offsetY + totalWarehouseHeight/2);
            ctx.lineTo(offsetX-40, offsetY + totalWarehouseHeight/2 + 15);
            ctx.closePath();
            ctx.fill();
            ctx.restore();

            // Draw Exit (right side)
            ctx.save();
            ctx.fillStyle = "green";
            ctx.beginPath();
            ctx.moveTo(offsetX + totalWarehouseWidth + 40, offsetY + totalWarehouseHeight/2 - 15);
            ctx.lineTo(offsetX + totalWarehouseWidth + 10, offsetY + totalWarehouseHeight/2);
            ctx.lineTo(offsetX + totalWarehouseWidth + 40, offsetY + totalWarehouseHeight/2 + 15);
            ctx.closePath();
            ctx.fill();
            ctx.restore();
        }

        // Draw default warehouse at load
        window.onload = drawWarehouse;
    </script>
</body>


  <!-- footer section -->
  <footer class="footer_section">
    <div class="container">
      <p>
        &copy; <span id="displayYear"></span> Op-Mic GOM 2025
      </p>
    </div>
  </footer>
  <!-- footer section -->

  <!-- bootstrap js -->
  <script src="js/bootstrap.js"></script>

</body>

<script>
  $(document).ready(function () {
    var steps = [
      {
        element: '#step1',
        intro: '<div class="tip-box"><img src="./images/intro/step31.jpg" style="width:100%;height:auto;"></div>',
        tooltipClass: 'step-tooltip',
        // position: 'bottom-right-aligned'
      },
    ]

    $(".course-btn").click(function () {
      var offset = $(this).offset();
      console.log("offset:", offset, $(this).index)

      var index = Number($(this).data("index"))

      $('body').find('.step-helperLayer').remove();

      // decoration
      var sw = $(window).width();
      var w = $(this).width();
      var h = $(this).height();
      $('body').append(`<div class="step-helperLayer" style="width:${w}px;height:${h}px;top:${offset.top}px;left:${offset.left}px;box-shadow:rgba(33, 33, 33, 0.8) 0px 0px 1px 2px, rgba(33, 33, 33, 0.5) 0px 0px 0px 5000px"></div>`);
      var stepfixedDom = $(`<div class='step-fixed-container' style="top:${offset.top + h}px;right:${sw - offset.left - w / 2}px"></div>`)

      var stepImg = $(`${steps[index - 1].intro}`);
      var sanjiaox = $(`<div class="triangle-up"></div>`)
      var closeDom = $(`<div class="close-btn"><img src="./images/close.png" /></div>`)

      // stepfixedDom
      stepfixedDom.append(stepImg);
      stepfixedDom.append(sanjiaox);
      stepfixedDom.append(closeDom);
      $('body').append(stepfixedDom)
    })

    $('body').on('click', '.step-fixed-container .close-btn', function () {
      $('body').find('.step-helperLayer').remove();
      $('body').find('.step-fixed-container').remove();
    });
    
  });
  
  
</script>

</html>