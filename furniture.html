<!DOCTYPE html>
<html>

<head>
    <!-- Basic -->
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <!-- Site Metas -->
    <link rel="icon" href="images/fevicon.png" type="image/gif"/>
    <meta name="keywords" content=""/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>


    <link rel="stylesheet" href="https://pyscript.net/latest/pyscript.css"/>
    <script defer src="https://pyscript.net/alpha/pyscript.js"></script>



    <title>Michael GOM</title>


    <!-- bootstrap core css -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css"/>

    <!-- fonts style -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,600,700&display=swap" rel="stylesheet"/>

    <!-- font awesome style -->
    <link href="css/font-awesome.min.css" rel="stylesheet"/>
    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet"/>
    <!-- responsive style -->
    <link href="css/responsive.css" rel="stylesheet"/>
    <py-env>
      - pandas
      - matplotlib
    </py-env>

</head>

<body class="sub_page">
<py-script src="sma.py"></py-script>
<py-script src="ema.py"></py-script>
<py-script src="wma.py"></py-script>
<py-script src="linear.py"></py-script>
<py-script src="holt.py"></py-script>
<div class="hero_area">
    <!-- header section strats -->
    <header class="header_section long_section px-0">
        <nav class="navbar navbar-expand-lg custom_nav-container ">
            <a class="navbar-brand" href="index.html">
          <span>
            Michael GOM
          </span>
            </a>
            </a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
                    aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class=""> </span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <div class="d-flex mx-auto flex-column flex-lg-row align-items-center">
                    <ul class="navbar-nav  ">
                        <li class="nav-item ">
                            <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="about.html"> About</a>
                        </li>
                        <li class="nav-item active">
                            <a class="nav-link" href="furniture.html">Forecasting Logistics</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="blog.html">Inventory Management</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="contact.html">Contact Us</a>
                        </li>
                    </ul>
                </div>
                <div class="quote_btn-container">
                    <a href="">
              <span>
                Project
              </span>
                        <i class="fa fa-user" aria-hidden="true"></i>
                    </a>
                    <form class="form-inline">
                        <button class="btn  my-2 my-sm-0 nav_search-btn" type="submit">
                            <i class="fa fa-search" aria-hidden="true"></i>
                        </button>
                    </form>
                </div>
            </div>
        </nav>
    </header>
    <!-- end header section -->
</div>

<!-- furniture section -->

<section class="furniture_section layout_padding">
    <div class="container">
        <div class="heading_container">
            <h2>
                Global Operation Management - Forecasting Logistics
            </h2>
            <p>
                This page aims to help you solve problems from Global operation management sector, specifically about
                Forecasting logistics.
            </p>
        </div>
        <div class="row">
          <div class="col-md-5 col-lg-4 mx-auto">
            <div class="box">
              <div class="detail-box">
                <h5>
                  Regular time series - Constand Trend(SWA)
                </h5>
                <div class="">
                    <input type="number" onkeyup="if(this.value<0)this.value=1" onblur="if(this.value<0)this.value=1" id="D1" placeholder="SWA Windows Size" style="width: 250px;">
                    <form id="upload-form" enctype="multipart/form-data">  
                      <input type="file" id="smaCsv" name="file" accept=".csv" style="width: 250px;">
                      <button type="button" onclick="uploadFile('smaCsv', 'sma_result', 'button_instant')">Upload and Solve Problem</button>  
                    </form>
                    <button id="button_instant" style="display: none;">Solve Problem</button>
                    <div id="sma_result" style="display: none;"></div>
                  <py-script>
                    import json
                    import pandas as pd

                    def get_plot_string(data, r):
                        result = calculate_sma(data, r)

                        # Predict next values
                        predicted_df = sma_predict_next_value(result)

                        # Plot data
                        plt = plot_sma_data(result, r, predicted_df)
      
                        buf = io.BytesIO()
                        plt.savefig(buf, format='png')
                        plt.close()
                        buf.seek(0)
                        # 将字节流编码为 base64
                        string = base64.b64encode(buf.read()).decode('utf-8')

                        # 输出图像标签的 HTML 代码
                        return "data:image/png;base64,"+ string
      
                    def on_instant(event):
                        try:
                          window_size = int(Element("D1").element.value)
                          json_str = Element("sma_result").element.innerHTML
                          if json_str != '':
                            json_data = json.loads(json_str)
                            df = pd.DataFrame(json_data)
                            df['T'] = pd.to_numeric(df['T'], errors='coerce').astype('int64')
                            df['Yt'] = pd.to_numeric(df['Yt'], errors='coerce').astype('float64') 
      
                            img_data = get_plot_string(df, window_size)
                            Element("out_instant").element.innerHTML = "Plt successed."
                          
                            Element("plot_image").element.src = img_data
                            Element("plot_image").element.style.display = "block"
                          else:
                            Element("out_instant").element.innerHTML = "Please upload csv file."
      
                        except ValueError:
                            Element("out_instant").element.innerHTML = "Invalid input. Please enter numeric values."
      
                    Element("button_instant").element.onclick = on_instant
                  </py-script>
                  <div id="out_instant"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-7">
            <div class="box">
              <div class="detail-box">
                <img id="plot_image" src="" alt="Inventory Plot" style="display:none;width: 700px;"/>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-5 col-lg-4 mx-auto">
            <div class="box">
              <div class="detail-box">
                <h5>
                  Regular time series - Constand Trend(WMA)
                </h5>
                <div class="">
                    <input type="number" onkeyup="if(this.value<0)this.value=1" onblur="if(this.value<0)this.value=1" id="C2" placeholder="WMA Windows Size" style="width: 250px;">
                    <input type="number" onkeyup="if(this.value<0)this.value=1" onblur="if(this.value<0)this.value=1" id="D2" placeholder="Forecast Periods" style="width: 250px;">
                    <form id="upload-form" enctype="multipart/form-data">  
                      <input type="file" id="wmaCsv" name="file" accept=".csv" style="width: 250px;">
                      <button type="button" onclick="uploadFile('wmaCsv', 'wma_result', 'button_instant1')">Upload and Solve Problem</button>  
                    </form>
                    <button id="button_instant1" style="display: none;">Solve Problem</button>
                    <div id="wma_result" style="display: none;"></div>
                  <py-script>
                    import json
                    import pandas as pd

                    def get_plot_string1(data, r, forecast_periods):
                        result = calculate_wma(data, r)
                        future_values = predict_future_values_wma(result, r, forecast_periods)
                        plt = plot_data_wma(result, r, future_values)
      
                        buf = io.BytesIO()
                        plt.savefig(buf, format='png')
                        plt.close()
                        buf.seek(0)
                        # 将字节流编码为 base64
                        string = base64.b64encode(buf.read()).decode('utf-8')

                        # 输出图像标签的 HTML 代码
                        return "data:image/png;base64,"+ string
      
                    def on_instant1(event):
                        try:
                          window_size = int(Element("C2").element.value)
                          forecast_periods = int(Element("D2").element.value)
                          json_str = Element("wma_result").element.innerHTML
                          if json_str != '':
                            json_data = json.loads(json_str)
                            df = pd.DataFrame(json_data)
                            df['T'] = pd.to_numeric(df['T'], errors='coerce').astype('int64')
                            df['Yt'] = pd.to_numeric(df['Yt'], errors='coerce').astype('float64') 
      
                            img_data = get_plot_string1(df, window_size, forecast_periods)
                            Element("out_instant1").element.innerHTML = "Plt successed."
                          
                            Element("plot_image1").element.src = img_data
                            Element("plot_image1").element.style.display = "block"
                          else:
                            Element("out_instant1").element.innerHTML = "Please upload csv file."
      
                        except ValueError:
                            Element("out_instant1").element.innerHTML = "Invalid input. Please enter numeric values."
      
                    Element("button_instant1").element.onclick = on_instant1
                  </py-script>
                  <div id="out_instant1"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-7">
            <div class="box">
              <div class="detail-box">
                <img id="plot_image1" src="" alt="Inventory Plot" style="display:none;width: 700px;"/>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-5 col-lg-4 mx-auto">
            <div class="box">
              <div class="detail-box">
                <h5>
                  Regular time series - Constand Trend(EMA)
                </h5>
                <div class="">
                    <input type="number" onkeyup="if(this.value<0)this.value=1" onblur="if(this.value<0)this.value=1" id="C3" placeholder="alpha" style="width: 250px;">
                    <form id="upload-form" enctype="multipart/form-data">  
                      <input type="file" id="emaCsv" name="file" accept=".csv" style="width: 250px;">
                      <button type="button" onclick="uploadFile('emaCsv', 'ema_result', 'button_instant2')">Upload and Solve Problem</button>  
                    </form>
                    <button id="button_instant2" style="display: none;">Solve Problem</button>
                    <div id="ema_result" style="display: none;"></div>
                  <py-script>
                    import json
                    import pandas as pd

                    def get_plot_string2(data, alpha):
                        result = calculate_ema(data, alpha)
                        plt = plot_data_ema(result, alpha)
      
                        buf = io.BytesIO()
                        plt.savefig(buf, format='png')
                        plt.close()
                        buf.seek(0)
                        # 将字节流编码为 base64
                        string = base64.b64encode(buf.read()).decode('utf-8')

                        # 输出图像标签的 HTML 代码
                        return "data:image/png;base64,"+ string
      
                    def on_instant2(event):
                        try:
                          alpha = float(Element("C3").element.value)
                          json_str = Element("ema_result").element.innerHTML
                          if json_str != '':
                            json_data = json.loads(json_str)
                            df = pd.DataFrame(json_data)
                            df['T'] = pd.to_numeric(df['T'], errors='coerce').astype('int64')
                            df['Yt'] = pd.to_numeric(df['Yt'], errors='coerce').astype('float64') 
      
                            img_data = get_plot_string2(df, alpha)
                            Element("out_instant2").element.innerHTML = "Plt successed."
                          
                            Element("plot_image2").element.src = img_data
                            Element("plot_image2").element.style.display = "block"
                          else:
                            Element("out_instant2").element.innerHTML = "Please upload csv file."
      
                        except ValueError:
                            Element("out_instant2").element.innerHTML = "Invalid input. Please enter numeric values."
      
                    Element("button_instant2").element.onclick = on_instant2
                  </py-script>
                  <div id="out_instant2"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-7">
            <div class="box">
              <div class="detail-box">
                <img id="plot_image2" src="" alt="Inventory Plot" style="display:none;width: 700px;"/>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-md-5 col-lg-4 mx-auto">
            <div class="box">
              <div class="detail-box">
                <h5>
                  Regular time series - Constand Trend(Regression)
                </h5>
                <div class="">
                    <input type="number" onkeyup="if(this.value<0)this.value=1" onblur="if(this.value<0)this.value=1" id="C4" placeholder="Predict Number" style="width: 250px;">
                    <form id="upload-form" enctype="multipart/form-data">  
                      <input type="file" id="LinearCsv" name="file" accept=".csv" style="width: 250px;">
                      <button type="button" onclick="uploadFile('LinearCsv', 'linear_result', 'button_instant3')">Upload and Solve Problem</button>  
                    </form>
                    <button id="button_instant3" style="display: none;">Solve Problem</button>
                    <div id="linear_result" style="display: none;"></div>
                  <py-script>
                    import json
                    import pandas as pd

                    def get_plot_string3(data, predict_number):
                        a_t, b_t, t, Y = calculate_linear_regression(data)

                        start_t = int(t[-1])  # last t
                        predictions = predict_linear(a_t, b_t, start_t, predict_number)
                        plt = plot_regression_linear(t, Y, a_t, b_t, predictions)
      
                        buf = io.BytesIO()
                        plt.savefig(buf, format='png')
                        plt.close()
                        buf.seek(0)
                        # 将字节流编码为 base64
                        string = base64.b64encode(buf.read()).decode('utf-8')

                        # 输出图像标签的 HTML 代码
                        return "data:image/png;base64,"+ string
      
                    def on_instant3(event):
                        try:
                          predict_number = int(Element("C4").element.value)
                          json_str = Element("linear_result").element.innerHTML
                          if json_str != '':
                            json_data = json.loads(json_str)
                            df = pd.DataFrame(json_data)
                            df['T'] = pd.to_numeric(df['T'], errors='coerce').astype('int64')
                            df['Yt'] = pd.to_numeric(df['Yt'], errors='coerce').astype('float64') 
      
                            img_data = get_plot_string3(df, predict_number)
                            Element("out_instant3").element.innerHTML = "Plt successed."
                          
                            Element("plot_image3").element.src = img_data
                            Element("plot_image3").element.style.display = "block"
                          else:
                            Element("out_instant3").element.innerHTML = "Please upload csv file."
      
                        except ValueError:
                            Element("out_instant3").element.innerHTML = "Invalid input. Please enter numeric values."
      
                    Element("button_instant1").element.onclick = on_instant3
                  </py-script>
                  <div id="out_instant3"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-7">
            <div class="box">
              <div class="detail-box">
                <img id="plot_image3" src="" alt="Inventory Plot" style="display:none;width: 700px;"/>
              </div>
            </div>
          </div>
        </div>
  
        <div class="row">
          <div class="col-md-5 col-lg-4 mx-auto">
            <div class="box">
              <div class="detail-box">
                <h5>
                  Regular time series - Constand Trend(Holt)
                </h5>
                <div class="">
                    <input type="number" onkeyup="if(this.value<0)this.value=1" onblur="if(this.value<0)this.value=1" id="C5" placeholder="alpha" style="width: 250px;">
                    <input type="number" onkeyup="if(this.value<0)this.value=1" onblur="if(this.value<0)this.value=1" id="D5" placeholder="beta" style="width: 250px;">
                    <input type="number" onkeyup="if(this.value<0)this.value=1" onblur="if(this.value<0)this.value=1" id="E5" placeholder="num_forecasts " style="width: 250px;">
                    <form id="upload-form" enctype="multipart/form-data">  
                      <input type="file" id="hotCsv" name="file" accept=".csv" style="width: 250px;">
                      <button type="button" onclick="uploadFile('hotCsv', 'hot_result', 'button_instant4')">Upload and Solve Problem</button>  
                    </form>
                    <button id="button_instant4" style="display: none;">Solve Problem</button>
                    <div id="hot_result" style="display: none;"></div>
                  <py-script>
                    import json
                    import pandas as pd

                    def get_plot_string4(data, alpha, beta, num_forecasts):
                        Y = data['Yt'].values
                        a, b, P = holt_linear_exponential_smoothing(Y, alpha, beta)

                        # Get last level and trend
                        last_a = a[-1]
                        last_b = b[-1]

                        # Forecast future values
                        future_forecasts = forecast_future_values_holt(
                            last_a, last_b, num_forecasts)
                        plt = plot_results_holt(Y, a, P, future_forecasts, num_forecasts)
      
                        buf = io.BytesIO()
                        plt.savefig(buf, format='png')
                        plt.close()
                        buf.seek(0)
                        # 将字节流编码为 base64
                        string = base64.b64encode(buf.read()).decode('utf-8')

                        # 输出图像标签的 HTML 代码
                        return "data:image/png;base64,"+ string
      
                    def on_instant2(event):
                        try:
                          alpha = float(Element("C5").element.value)
                          beta = float(Element("D5").element.value)
                          num_forecasts = int(Element("E5").element.value)
                          if not (0 < alpha < 1):
                            raise ValueError("Alpha must be between 0 and 1.")
                          if not (0 < beta < 1):
                            raise ValueError("Beta must be between 0 and 1.")
                          json_str = Element("hot_result").element.innerHTML
                          if json_str != '':
                            json_data = json.loads(json_str)
                            df = pd.DataFrame(json_data)
                            df['T'] = pd.to_numeric(df['T'], errors='coerce').astype('int64')
                            df['Yt'] = pd.to_numeric(df['Yt'], errors='coerce').astype('float64') 
      
                            img_data = get_plot_string4(df, alpha, beta, num_forecasts)
                            Element("out_instant4").element.innerHTML = "Plt successed."
                          
                            Element("plot_image4").element.src = img_data
                            Element("plot_image4").element.style.display = "block"
                          else:
                            Element("out_instant4").element.innerHTML = "Please upload csv file."
      
                        except ValueError:
                            Element("out_instant4").element.innerHTML = "Invalid input. Please enter numeric values."
      
                    Element("button_instant4").element.onclick = on_instant2
                  </py-script>
                  <div id="out_instant4"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-7">
            <div class="box">
              <div class="detail-box">
                <img id="plot_image4" src="" alt="Inventory Plot" style="display:none;width: 700px;"/>
              </div>
            </div>
          </div>
        </div>
    </div>
</section>


<!-- footer section -->
<footer class="footer_section">
    <div class="container">
        <p>
            &copy; <span id="displayYear"></span> Michael
            <a href="https://html.design/">2024</a>
        </p>
    </div>
</footer>
<!-- footer section -->

<script>
  function uploadFile(fileId, displayId, buttonId) {  
    const fileInput = document.getElementById(fileId);  
    const file = fileInput.files[0];  
  
    if (file) {  
        const reader = new FileReader();  
  
        reader.onload = function(e) {  
            const text = e.target.result;  
            const data = parseCSV(text);  
            displayData(data, displayId);  
            clickButtonById(buttonId);
        };  
  
        reader.onerror = function(e) {  
            console.error("File could not be read! Code " + e.target.error.code);  
        };  
  
        reader.readAsText(file);  
    } else {  
        alert('Please select a CSV file.');  
    }  
}  
  
function parseCSV(csv) {  
    const lines = csv.trim().split('\n');  
    const headers = lines[0].split(',');  
    const data = lines.slice(1).map(line => {  
        const values = line.split(',');  
        const row = {};  
        headers.forEach((header, index) => {  
            row[header.trim()] = values[index]?.trim() ?? '';  
        });  
        return row;  
    });  
    console.log(data)
    return data;  
}  
  
function displayData(data, ElementId) {  
    const result = document.getElementById(ElementId);  
    result.textContent = JSON.stringify(data, null, 2); // 使用缩进为2的空格来格式化JSON 
}

function clickButtonById(buttonId) {
  // TODO: cheak the id if button
  document.getElementById(buttonId).click();
}
</script>
<!-- jQery -->
<script src="js/jquery-3.4.1.min.js"></script>
<!-- bootstrap js -->
<script src="js/bootstrap.js"></script>
<!-- custom js -->
<script src="js/custom.js"></script>
<!-- Google Map -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap"></script>
<!-- End Google Map -->

</body>

</html>
